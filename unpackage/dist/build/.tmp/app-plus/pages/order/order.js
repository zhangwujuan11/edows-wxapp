(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/order"],{"25ea":function(e,t,r){"use strict";r.r(t);var a=r("ac47"),n=r("86f7");for(var o in n)"default"!==o&&function(e){r.d(t,e,function(){return n[e]})}(o);r("bebc");var s=r("2877"),i=Object(s["a"])(n["default"],a["a"],a["b"],!1,null,null,null);t["default"]=i.exports},"86f7":function(e,t,r){"use strict";r.r(t);var a=r("e098"),n=r.n(a);for(var o in a)"default"!==o&&function(e){r.d(t,e,function(){return a[e]})}(o);t["default"]=n.a},ac47:function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement;e._self._c},n=[];r.d(t,"a",function(){return a}),r.d(t,"b",function(){return n})},bebc:function(e,t,r){"use strict";var a=r("ddf6"),n=r.n(a);n.a},ddf6:function(e,t,r){},e098:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(r("a34a")),n=r("2f62");o(r("98be"));function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t,r,a,n,o,s){try{var i=e[o](s),u=i.value}catch(c){return void r(c)}i.done?t(u):Promise.resolve(u).then(a,n)}function i(e){return function(){var t=this,r=arguments;return new Promise(function(a,n){var o=e.apply(t,r);function i(e){s(o,a,n,i,u,"next",e)}function u(e){s(o,a,n,i,u,"throw",e)}i(void 0)})}}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),a.forEach(function(t){c(e,t,r[t])})}return e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var d=function(){return r.e("components/uni-load-more/uni-load-more").then(r.bind(null,"b9eb"))},l=function(){return r.e("components/empty").then(r.bind(null,"b1eb"))},f={components:{uniLoadMore:d,empty:l},computed:u({},(0,n.mapState)(["hasLogin","userInfo"])),data:function(){return{res:{},serviceNo:"400-988-6868",tabCurrentIndex:0,orderStatus:"",orderList:[],pageNo:1,pageSize:10,totalPage:0,refundDetailVO:[],navList:[{state:0,text:"全部",orderStatus:"",loadingType:"more",orderList:[]},{state:1,text:"待付款",loadingType:"more",orderStatus:"101",orderList:[]},{state:2,text:"待收货",loadingType:"more",orderStatus:"102",orderList:[]},{state:3,text:"已完成",loadingType:"more",orderStatus:"107",orderList:[]}]}},onLoad:function(t){var r=getCurrentPages()[0].route;console.log("当前路由：",r," at pages\\order\\order.vue:177"),this.hasLogin||e.reLaunch({url:"/pages/wxAuth/wxAuth?returnUrl="+r}),console.log(t.state," at pages\\order\\order.vue:187"),this.tabCurrentIndex=+t.state,this.loadData()},methods:{getData:function(){var t=i(a.default.mark(function t(r,n){var o,s=this;return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.res={},o={orderStatus:r,pageNo:this.pageNo,pageSize:this.pageSize},t.next=4,this.$axios(this.$baseUrl.getOrderList,JSON.stringify(o));case 4:this.res=t.sent,1==this.pageNo&&(this.totalPage=this.res.data.pages),this.orderList=this.res.data.data.filter(function(e){return e=Object.assign(e,s.orderStateExp(e.orderStatus)),""===r?e:"102"===r?"102"===e.orderStatus||"103"===e.orderStatus:e.orderStatus===r}),this.orderList.forEach(function(e){n.orderList.push(e)}),this.$set(n,"loaded",!0),this.pageNo>=this.totalPage?(e.stopPullDownRefresh(),this.pageNo=this.totalPage+1,n.loadingType="noMore"):(this.pageNo=this.pageNo+1,console.log(this.pageNo," at pages\\order\\order.vue:244"),this.getData(r,n),n.loadingType="more");case 10:case"end":return t.stop()}},t,this)}));function r(e,r){return t.apply(this,arguments)}return r}(),loadData:function(e){var t=this.tabCurrentIndex,r=this.navList[t],a=r.orderStatus;console.log("来源：",e," at pages\\order\\order.vue:256"),"tabChange"===e&&!0===r.loaded&&this.$set(r,"loaded",!1),"loading"!==r.loadingType&&(r.loadingType="loading",this.getData(a,r),setTimeout(function(){},600))},changeTab:function(e){this.tabCurrentIndex=e.target.current,this.orderList=[],this.pageNo=1,this.totalPage=0;var t=this.tabCurrentIndex,r=this.navList[t];r.orderStatus;r.orderList=[],this.loadData("tabChange")},tabClick:function(e){this.tabCurrentIndex=e},toPay:function(){var t=i(a.default.mark(function t(r){var n,o=this;return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:n=this,e.login({provider:"weixin",success:function(){var t=i(a.default.mark(function t(s){var i,u;return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return i={orderSn:r.orderSn,openId:e.getStorageSync("openId")?e.getStorageSync("openId"):""},console.log(i," at pages\\order\\order.vue:302"),t.next=4,o.$axios(o.$baseUrl.orderPayer,i);case 4:u=t.sent,console.log("返回数据：",u.data.data," at pages\\order\\order.vue:304"),e.requestPayment({provider:"wxpay",appId:u.data.data.appId,timeStamp:u.data.data.timeStamp,nonceStr:u.data.data.nonceStr,package:u.data.data.packageValue,signType:u.data.data.signType,paySign:u.data.data.paySign,success:function(t){e.redirectTo({url:"/pages/money/paySuccess?totalPrice="+r.totalPrice})},fail:function(e){n.$api.msg("支付失败"),console.log("fail:"+JSON.stringify(e)," at pages\\order\\order.vue:320")}});case 7:case"end":return t.stop()}},t,this)}));function s(e){return t.apply(this,arguments)}return s}()});case 2:case"end":return t.stop()}},t,this)}));function r(e){return t.apply(this,arguments)}return r}(),confirm:function(){var t=i(a.default.mark(function t(r){var n=this;return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this,e.showModal({content:"确认已收货？",success:function(){var t=i(a.default.mark(function t(o){var s;return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!o.confirm){t.next=6;break}return s={orderSn:r.orderSn},t.next=4,n.$axios(n.$baseUrl.orderConfirmation,s);case 4:t.sent,e.redirectTo({url:"/pages/order/order?state=3"});case 6:case"end":return t.stop()}},t,this)}));function o(e){return t.apply(this,arguments)}return o}()});case 2:case"end":return t.stop()}},t,this)}));function r(e){return t.apply(this,arguments)}return r}(),refundOrder:function(t){e.navigateTo({url:"/pages/order/refund?orderSn="+t.orderSn})},refundOrderDetail:function(t){e.navigateTo({url:"/pages/order/refundDetail?orderSn="+t.orderSn})},makePhoneCall:function(){e.makePhoneCall({phoneNumber:this.serviceNo,success:function(){console.log("成功拨打电话"," at pages\\order\\order.vue:381")}})},toEvalu:function(t){e.navigateTo({url:"/pages/evaluate/evaluate?orderSn="+t.orderSn})},deleteOrder:function(){var t=i(a.default.mark(function t(r,n){var o=this;return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e.showModal({content:"确认删除此订单？",success:function(){var e=i(a.default.mark(function e(t){var s,i;return a.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!t.confirm){e.next=6;break}return s={orderSn:n.orderSn},e.next=4,o.$axios(o.$baseUrl.deleteOrder,s);case 4:i=e.sent,200==i.data.code&&setTimeout(function(){o.navList[o.tabCurrentIndex].orderList.splice(r,1)},600);case 6:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()});case 1:case"end":return t.stop()}},t,this)}));function r(e,r){return t.apply(this,arguments)}return r}(),cancelOrder:function(){var t=i(a.default.mark(function t(r){var n,o,s=this;return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e.showLoading({title:"请稍后"}),console.log(r," at pages\\order\\order.vue:415"),n={orderSn:r.orderSn},t.next=5,this.$axios(this.$baseUrl.cancelOrder,n);case 5:o=t.sent,200==o.data.code&&setTimeout(function(){var t=s.orderStateExp(105),a=t.stateTip,n=t.stateTipColor;r=Object.assign(r,{orderStatus:105,stateTip:a,stateTipColor:n});var o=s.navList[1].orderList,i=o.findIndex(function(e){return e.id===r.id});-1!==i&&o.splice(i,1),e.hideLoading()},600);case 7:case"end":return t.stop()}},t,this)}));function r(e){return t.apply(this,arguments)}return r}(),orderStateExp:function(e){var t="",r="#fa436a";switch(+e){case 101:t="待付款";break;case 102:t="已付款",r="#339cfe";break;case 103:t="已发货",r="#339cfe";break;case 104:t="已签收",r="#339cfe";break;case 105:t="已取消",r="#909399";break;case 106:t="已退款",r="#333333";break;case 107:t="已完成",r="#339cfe";break;case 108:t="退款中",r="#333333";break;case 109:t="退款拒绝",r="#f04c41";break}return{stateTip:t,stateTipColor:r}}}};t.default=f}).call(this,r("6e42")["default"])}},[["3019","common/runtime","common/vendor"]]]);