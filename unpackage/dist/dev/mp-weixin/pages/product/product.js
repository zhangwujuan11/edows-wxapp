(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/product/product"],{199:function(t,e,r){"use strict";(function(t,e){var a=r(4);r(26);a(r(25));var n=a(r(200));t.__webpack_require_UNI_MP_PLUGIN__=r,e(n.default)}).call(this,r(1)["default"],r(2)["createPage"])},200:function(t,e,r){"use strict";r.r(e);var a=r(201),n=r(203);for(var s in n)["default"].indexOf(s)<0&&function(t){r.d(e,t,(function(){return n[t]}))}(s);r(205);var i,o=r(34),u=Object(o["default"])(n["default"],a["render"],a["staticRenderFns"],!1,null,null,null,!1,a["components"],i);u.options.__file="pages/product/product.vue",e["default"]=u.exports},201:function(t,e,r){"use strict";r.r(e);var a=r(202);r.d(e,"render",(function(){return a["render"]})),r.d(e,"staticRenderFns",(function(){return a["staticRenderFns"]})),r.d(e,"recyclableRender",(function(){return a["recyclableRender"]})),r.d(e,"components",(function(){return a["components"]}))},202:function(t,e,r){"use strict";var a;r.r(e),r.d(e,"render",(function(){return n})),r.d(e,"staticRenderFns",(function(){return i})),r.d(e,"recyclableRender",(function(){return s})),r.d(e,"components",(function(){return a}));try{a={wmWatermark:function(){return r.e("components/wm-watermark/wm-watermark").then(r.bind(null,798))}}}catch(o){if(-1===o.message.indexOf("Cannot find module")||-1===o.message.indexOf(".vue"))throw o;console.error(o.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var n=function(){var t=this,e=t.$createElement,r=(t._self._c,0==t.currentIndex?t._f("formatRichText")(t.desc):null),a=1==t.currentIndex?t.__map(t.productComments,(function(e,r){var a=t.__get_orig(e),n=t.productComments.length;return{$orig:a,g0:n}})):null,n=1==t.currentIndex?t.productComments.length:null;t.$mp.data=Object.assign({},{$root:{f0:r,l0:a,g1:n}})},s=!1,i=[];n._withStripped=!0},203:function(t,e,r){"use strict";r.r(e);var a=r(204),n=r.n(a);for(var s in a)["default"].indexOf(s)<0&&function(t){r.d(e,t,(function(){return a[t]}))}(s);e["default"]=n.a},204:function(t,e,r){"use strict";(function(t){var a=r(4);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(r(61)),s=a(r(63)),i=a(r(11)),o=r(28),u=r(179);function c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function d(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach((function(e){(0,i.default)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var l=function(){r.e("components/share").then(function(){return resolve(r(805))}.bind(null,r)).catch(r.oe)},f=function(){r.e("components/swiperDot").then(function(){return resolve(r(784))}.bind(null,r)).catch(r.oe)},p=function(){r.e("components/uni-number-box").then(function(){return resolve(r(812))}.bind(null,r)).catch(r.oe)},h={components:{share:l,swiperDot:f,uniNumberBox:p},data:function(){return{max:99999,isIphoneX:!1,optionType:"",productNum:1,productCode:"",isFixed:!1,productInfo:{},oldProductInfo:{},specClass:"none",seviceClass:"none",specSelected:[],defualtAttrList:[],current:0,favorite:!0,shareList:[],imgList:[],serviceList:[],desc:"",attrList:[],productComments:[],productNavs:["商品详情","商品评价"],currentIndex:0,userStar:[1,2,3,4,5],cartNum:0}},computed:d({},(0,o.mapState)(["hasLogin","userInfo"])),onLoad:function(t){var e=this;return(0,s.default)(n.default.mark((function r(){var a,s;return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:void 0!=t.scene?(a=decodeURIComponent(t.scene),s=a.lastIndexOf("="),e.productCode=a.substring(s+1,a.length)):e.productCode=t.code,e.isIphoneX=getApp().globalData.isIphoneX,e.getData(),e.getCartNum(),e.getProductComments();case 5:case"end":return r.stop()}}),r)})))()},onShareAppMessage:function(t){return{title:this.productInfo.name,path:"/pages/product/product?code="+this.productCode}},methods:{getData:function(){var t=this;return(0,s.default)(n.default.mark((function e(){var r,a,s,i;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r={attrValueDtos:t.defualtAttrList,productCode:t.productCode},e.next=3,t.$axios(t.$baseUrl.getProductByCode,r);case 3:for(s in a=e.sent,t.productInfo=a.data.data,t.desc=a.data.data.detail,t.imgList=a.data.data.subImgList,t.serviceList=a.data.data.serviceList,t.attrList=a.data.data.attrList,t.defualtAttrList=a.data.data.defualtAttrList,t.attrList)if(t.attrList[s].code==t.defualtAttrList[s].attrCode)for(i in t.attrList[s].valueList)t.attrList[s].valueList[i].name==t.defualtAttrList[s].attrValue&&t.$set(t.attrList[s].valueList[i],"selected",!0);case 11:case"end":return e.stop()}}),e)})))()},getDataser:function(){var t=this;return(0,s.default)(n.default.mark((function e(){var r,a,s,i;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r={attrValueDtos:t.defualtAttrList,productCode:t.productCode},e.next=3,t.$axios(t.$baseUrl.getProductByCode,r);case 3:for(s in a=e.sent,t.productInfo=a.data.data,t.desc=a.data.data.detail,t.imgList=a.data.data.subImgList,t.serviceList=a.data.data.serviceList,t.attrList=a.data.data.attrList,t.defualtAttrList=a.data.data.defualtAttrList,t.attrList)if(t.attrList[s].code==t.defualtAttrList[s].attrCode)for(i in t.attrList[s].valueList)t.attrList[s].valueList[i].name==t.defualtAttrList[s].attrValue&&t.$set(t.attrList[s].valueList[i],"selected",!0);case 11:case"end":return e.stop()}}),e)})))()},toggleSpec:function(t){var e=this;if(this.optionType=t,"show"===this.specClass){this.specClass="hide";var r=0,a=this.defualtAttrList.length;for(var n in this.defualtAttrList)" "!=this.defualtAttrList[n].attrValue&&(r+=1);r!=a&&(this.productInfo=this.oldProductInfo,this.imgList=this.oldProductInfo.subImgList,this.serviceList=this.oldProductInfo.serviceList,this.defualtAttrList=this.oldProductInfo.defualtAttrList,this.attrList=this.oldProductInfo.attrList,this.selectSpec(0,0,this.attrList[0].valueList[0].pCode)),setTimeout((function(){e.specClass="none"}),250)}else"none"===this.specClass&&(this.specClass="show")},selectSpec:function(t,e,r){var a=this,n=this.attrList,s=0,i=this.productInfo.defualtAttrList.length;for(var o in this.productInfo.defualtAttrList)" "!=this.productInfo.defualtAttrList[o].attrValue&&(s+=1);s==i&&(this.oldProductInfo=this.productInfo);var u=n[t].valueList[e].selected||!1;for(var o in n[t].valueList)n[t].valueList[o].pCode==r&&this.$set(n[t].valueList[o],"selected",!1);if(u){if(this.$set(n[t].valueList[e],"selected",!1),n[t+1])for(var c=0;c<n[t+1].valueList.length;c++)this.$set(n[t+1].valueList[c],"selected",!1);if(n[t+2])for(c=0;c<n[t+2].valueList.length;c++)this.$set(n[t+2].valueList[c],"selected",!1)}else{if(this.$set(n[t].valueList[e],"selected",!0),n[t+1])for(c=0;c<n[t+1].valueList.length;c++)this.$set(n[t+1].valueList[c],"selected",!1);if(n[t+2])for(c=0;c<n[t+2].valueList.length;c++)this.$set(n[t+2].valueList[c],"selected",!1)}this.defualtAttrList=[],n.forEach((function(t){for(var e in t.valueList){var r={};!0===t.valueList[e].selected&&(r.attrCode=t.valueList[e].pCode,r.attrValue=t.valueList[e].name,a.defualtAttrList.push(r))}})),this.getDataser()},getCartNum:function(){var t=this;return(0,s.default)(n.default.mark((function e(){var r,a;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r={pageNo:1,pageSize:999},e.next=3,t.$axios(t.$baseUrl.getShoppingCartList,r);case 3:a=e.sent,200==a.data.code&&(t.cartNum=a.data.count);case 5:case"end":return e.stop()}}),e)})))()},getProductComments:function(){var t=this;return(0,s.default)(n.default.mark((function e(){var r,a,s;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r={pageNo:1,pageSize:999,productCode:t.productCode},e.next=3,t.$axios(t.$baseUrl.getProductComments,r);case 3:for(s in a=e.sent,t.productComments=a.data.data,t.productComments)t.productComments[s].createDate=u.fn.formatTime(t.productComments[s].createDate,"Y-M-D");case 6:case"end":return e.stop()}}),e)})))()},cngProNav:function(t){this.currentIndex=t},swiperChange:function(t){this.current=t.detail.current},preview:function(e){var r=e.currentTarget.id;t.previewImage({urls:this.imgList,current:r})},toCart:function(){t.navigateTo({url:"/pages/cart/cart",success:function(t){var e=getCurrentPages().pop();void 0!=e&&null!=e&&e.onLoad()}})},toIndex:function(){t.switchTab({url:"/pages/index/index",success:function(t){var e=getCurrentPages().pop();void 0!=e&&null!=e&&e.onLoad()}})},numberChange:function(t){this.productNum=t.number,this.productNum>this.max&&(this.productNum=this.max)},toggleService:function(){var t=this;"show"===this.seviceClass?(this.seviceClass="hide",setTimeout((function(){t.seviceClass="none"}),250)):"none"===this.seviceClass&&(this.seviceClass="show")},toggleSpecSur:function(){var e=this;return(0,s.default)(n.default.mark((function r(){var a,s,i,o,u;return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:a=0;case 1:if(!(a<e.defualtAttrList.length)){r.next=8;break}if(" "!=e.defualtAttrList[a].attrValue){r.next=5;break}return e.$api.msg("请选择"+e.attrList[a].name),r.abrupt("return",!1);case 5:a++,r.next=1;break;case 8:if("cart"!=e.optionType){r.next=14;break}return s={attrValues:e.defualtAttrList,num:e.productNum,productCode:e.productCode},r.next=12,e.$axios(e.$baseUrl.addShoppingCart,JSON.stringify(s));case 12:i=r.sent,200==i.data.code&&(e.getCartNum(),e.$api.msg("加入购物车成功！"));case 14:"buy"==e.optionType&&(o=[],u={productName:e.productInfo.name,price:e.productInfo.price,productCode:e.productInfo.productCode,imgPath:e.productInfo.masterImg,attrValueVOList:e.productInfo.defualtAttrList,isGift:e.productInfo.isGift,giftVOList:e.productInfo.giftVOList,productType:e.productInfo.productType,useSecurityBalance:e.productInfo.useSecurityBalance},o.push({productList:u,productNum:e.productNum}),t.setStorage({key:"tmpOrderData",data:o}),t.navigateTo({url:"/pages/order/createOrder"})),setTimeout((function(){e.specClass="none"}),250);case 16:case"end":return r.stop()}}),r)})))()},share:function(){this.$refs.share.toggleMask()},toFavorite:function(){this.favorite=!this.favorite},buy:function(){t.navigateTo({url:"/pages/order/createOrder"})},stopPrevent:function(){}},filters:{formatRichText:function(t){if(t){var e=t.replace(/<img[^>]*>/gi,(function(t,e){return t=t.replace(/style="[^"]+"/gi,"").replace(/style='[^']+'/gi,""),t=t.replace(/width="[^"]+"/gi,"").replace(/width='[^']+'/gi,""),t=t.replace(/height="[^"]+"/gi,"").replace(/height='[^']+'/gi,""),t}));return e=e.replace(/style="[^"]+"/gi,(function(t,e){return t=t.replace(/width:[^;]+;/gi,"max-width:100%;").replace(/width:[^;]+;/gi,"max-width:100%;"),t})),e=e.replace(/<br[^>]*\/>/gi,""),e=e.replace(/\<img/gi,'<img style="max-width:100%;height:auto;display:flex; flex-direction: column; margin:0 auto ;"'),e}}},onPageScroll:function(t){t.scrollTop>460?this.isFixed=!0:this.isFixed=!1}};e.default=h}).call(this,r(2)["default"])},205:function(t,e,r){"use strict";r.r(e);var a=r(206),n=r.n(a);for(var s in a)["default"].indexOf(s)<0&&function(t){r.d(e,t,(function(){return a[t]}))}(s);e["default"]=n.a},206:function(t,e,r){}},[[199,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/product/product.js.map